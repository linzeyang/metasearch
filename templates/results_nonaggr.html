{% extends "base.html" %}

{% block metadescription %}Results for {{ raw_query }} (Non-aggregated){% endblock %}

{% block title %}
    Results for "{{ raw_query }}" (Non-aggregated) -- MetaSearch
{% endblock %}

{% block content %}
  <form id="form_search" class="form-signin results" action="/search/" method="get">
    <img src="/static/logo_small.png" id="logo_small" alt="MetaSearch" />
    <input type="text" name="query" id="input_query" class="form-control" value="{{ raw_query }}" maxlength="100" />
    <input type="submit" id="button_search" class="btn btn-lg btn-primary" value="Search" />
    <div id="checkboxes">
      <input type="checkbox" name="bing" id="box_bing" {% if showBing %}checked="checked" {% endif %}/><label for="box_bing">Bing</label>
      <input type="checkbox" name="blekko" id="box_blekko" {% if showBlekko %}checked="checked" {% endif %}/><label for="box_blekko">Blekko</label>
      <!-- EntireWeb is temporarily disabled as its API is not available occasionally -->
      <input type="checkbox" name="entweb" id="box_entweb" {% if showEntweb %}checked="checked" {% endif %} title="Currently Disabled" disabled /><label for="box_entweb">EntireWeb</label><br />
    </div>
    <select name="aggr" id="select_aggr">
      <option value="false" selected="selected">Non-Aggregated</option>
      <option value="true">Aggregated</option>
    </select>
    <select name="cluster" id="select_cluster">
      <option value="false" {% if not cluster %}selected="selected"{% endif %}>Non-Clustered</option>
      <option value="true" {% if cluster %}selected="selected"{% endif %}>Clustered</option>
    </select>
  </form>
  <br />
  <div class="pagelist" align="center">
  {% for page in page_list %}
    <a href="{{ full_path }}&page={{ page }}">
    {% if page == current_page %}
      <b>[{{ page }}]</b>
    {% else %}
      {{ page }}
    {% endif %}
    </a>&nbsp;&nbsp;&nbsp;
  {% endfor %}
  </div>
  <br />    
  {% if showBing %} <!-- Bing Section -->
    <img src="/static/BING.png" alt="Bing" />
    {% if cluster %} <!-- cluster is enabled -->
      {% for cluster in bingClusters %}
        <p><b>Cluster {{ forloop.counter }}</b></p>
        <ul>
        {% for i in cluster %}
          <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title }}</a><br />
          <span class="displayurl">{{ i.displayurl }}</span><br />
          <p>{{ i.snippet }}</p></li>
        {% endfor %}
        </ul>
      {% empty %}
          <p class="error" align="center">ERROR: No results retrieved from Bing</p>
      {% endfor %}
    {% else %} <!-- cluster is disabled -->
      <ul>
      {% for i in bingList %}
        <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title }}</a><br />
        <span class="displayurl">{{ i.displayurl }}</span><br />
        <p>{{ i.snippet }}</p></li>
      {% empty %}
        <p class="error" align="center">ERROR: No results retrieved from Bing</p>
      {% endfor %}
      </ul>
    {% endif %}
    <hr />
  {% endif %}
  {% if showBlekko %} <!-- Blekko Section -->
    <img src="/static/Blekko.png" alt="Blekko" />
    {% if cluster %} <!-- cluster is enabled -->
      {% for cluster in blekkoClusters %}
        <p><b>Cluster {{ forloop.counter }}</b></p>
        <ul>
        {% for i in cluster %}
          <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title|safe }}</a><br />
          <span class="displayurl">{{ i.displayurl|safe }}</span><br />
          <p>{{ i.snippet|safe }}</p></li>
        {% endfor %}
        </ul>
      {% empty %}
        <p class="error" align="center">ERROR: No results retrieved from Blekko</p>
      {% endfor %}
    {% else %} <!-- cluster is disabled -->
      <ul>
      {% for i in blekkoList %}
        <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title|safe }}</a><br />
        <span class="displayurl">{{ i.displayurl|safe }}</span><br />
        <p>{{ i.snippet|safe }}</p></li>
      {% empty %}
        <p class="error" align="center">ERROR: No results retrieved from Blekko</p>
      {% endfor %}
      </ul>
    {% endif %}
    <hr />
  {% endif %}
  {% if showEntweb %} <!-- EntireWeb Section -->
    <img src="/static/EntireWeb.png" alt="EntireWeb" />
    {% if cluster %} <!-- cluster is enabled -->
      {% for cluster in entwebClusters %}
        <p><b>Cluster {{ forloop.counter }}</b></p>
        <ul>
        {% for i in cluster %}
          <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title }}</a><br />
          <span class="displayurl">{{ i.displayurl }}</span><br />
          <p>{{ i.snippet }}</p></li>
        {% endfor %}
        </ul>
      {% empty %}
        <p class="error" align="center">ERROR: No results retrieved from EntireWeb</p>
      {% endfor %}
    {% else %} <!-- cluster is disabled -->
      <ul>
      {% for i in entwebList %}
        <li class="item"><a href="{{ i.url }}" target="_blank">{{ i.title }}</a><br />
        <span class="displayurl">{{ i.displayurl }}</span><br />
        <p>{{ i.snippet }}</p></li>
      {% empty %}
        <p class="error" align="center">ERROR: No results retrieved from EntireWeb</p>
      {% endfor %}
      </ul>
    {% endif %}
    <hr />
  {% endif %}
  <br />
  <div class="pagelist" align="center">
  {% for page in page_list %}
    <a href="{{ full_path }}&page={{ page }}">
    {% if page == current_page %}
      <b>[{{ page }}]</b>
    {% else %}
      {{ page }}
    {% endif %}
    </a>&nbsp;&nbsp;&nbsp;
  {% endfor %}
  </div><br />
{% endblock %}
